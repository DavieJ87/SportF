<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NBA Game Predictor</title>
    <!-- Link to External CSS -->
    <link rel="stylesheet" href="styles/styles.css">
</head>
<body>
    <header>
        <h1>NBA Game Predictor</h1>
        <div id="user-info">Loading...</div>
    </header>

    <main>
        <!-- Date Selection Menu -->
        <div id="dateMenuContainer" class="date-scroller"></div>

        <!-- Game Table -->
        <div id="gameTable" class="game-table hidden">
            <table>
                <thead>
                    <tr>
                        <th>Away Team</th>
                        <th>Home Team</th>
                        <th>Select Winner</th>
                    </tr>
                </thead>
                <tbody id="gameTableBody">
                    <!-- Games will be dynamically inserted here -->
                </tbody>
            </table>
        </div>

        <!-- Submit button -->
        <button id="submitBtn">Submit</button>
    </main>

    <!-- Firebase SDK (Modular v9) -->
    <script type="module">
        // Import Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.4/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.8.4/firebase-auth.js";
        import { getDatabase, ref, get, set } from "https://www.gstatic.com/firebasejs/9.8.4/firebase-database.js";

        // Your Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDaQnfeZFAFy8FNv1OiTisa50Vao9kT3OI",
            authDomain: "sportf-8c772.firebaseapp.com",
            databaseURL: "https://sportf-8c772-default-rtdb.firebaseio.com",
            projectId: "sportf-8c772",
            storageBucket: "sportf-8c772.appspot.com",
            messagingSenderId: "523775447476",
            appId: "1:523775447476:web:0f7a1a95fdc8fe7e02a2e1"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const database = getDatabase(app);

        // Google Authentication
        const provider = new GoogleAuthProvider();

        onAuthStateChanged(auth, (user) => {
            const userInfo = document.getElementById('user-info');
            if (user) {
                userInfo.textContent = `Hello, ${user.displayName}`;
                loadPredictions(user.uid);
            } else {
                userInfo.textContent = "Not signed in. Please sign in.";
                // Sign in with Google
                signInWithPopup(auth, provider).catch((error) => {
                    console.error("Sign in error: ", error);
                });
            }
        });

        // Load predictions for the user
        async function loadPredictions(userId) {
            try {
                const predictionsRef = ref(database, 'predictions/' + userId);
                const snapshot = await get(predictionsRef);
                if (snapshot.exists()) {
                    console.log("User predictions: ", snapshot.val());
                    // You can load predictions to the game table here
                } else {
                    console.log("No predictions found.");
                }
            } catch (error) {
                console.error("Error loading predictions: ", error);
            }
        }

        // Add event listeners to the date menu and submit button
        document.getElementById('submitBtn').addEventListener('click', () => {
            // Save predictions logic here
            console.log('Submit predictions');
        });

        // Additional functionality to load the game table, date selection, etc., would go here
    </script>

</body>
</html>
